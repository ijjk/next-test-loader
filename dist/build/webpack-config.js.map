{"version":3,"sources":["../../build/webpack-config.ts"],"names":["isWebpack5","parseInt","webpack","version","semver","lt","Log","error","process","exit","devtoolRevertWarning","devtool","console","warn","chalk","yellow","bold","parseJsonFile","filePath","JSON5","require","contents","trim","parse","err","codeFrame","String","start","line","lineNumber","column","columnNumber","message","highlightCode","Error","getOptimizedAliases","isServer","stubWindowFetch","path","join","__dirname","stubObjectAssign","shimAssign","Object","assign","unfetch$","url","resolve","attachReactRefresh","webpackConfig","targetLoader","injections","reactRefreshLoaderName","reactRefreshLoader","module","rules","forEach","rule","curr","use","Array","isArray","some","r","idx","findIndex","splice","info","getBaseWebpackConfig","dir","buildId","config","dev","pagesDir","target","reactProductionProfiling","entrypoints","rewrites","plugins","babelPresetPlugins","hasRewrites","length","experimental","env","pluginLoaderOptions","plugin","middleware","includes","push","directory","reactVersion","cwd","name","hasReactRefresh","hasJsxRuntime","Boolean","gte","distDir","defaultLoaders","babel","loader","options","cache","development","hotSelfAccept","babelIncludeRegexes","VALID_MIDDLEWARE","map","RegExp","nodePathList","NODE_PATH","split","platform","filter","p","isServerless","isServerlessTrace","isLikeServerless","outputDir","SERVERLESS_DIRECTORY","SERVER_DIRECTORY","outputPath","totalPages","keys","clientEntries","CLIENT_STATIC_FILES_RUNTIME_MAIN","relative","NEXT_PROJECT_ROOT_DIST_CLIENT","replace","CLIENT_STATIC_FILES_RUNTIME_POLYFILLS","undefined","typeScriptPath","paths","_","tsConfigPath","useTypeScript","jsConfig","ts","tsConfig","compilerOptions","jsConfigPath","resolvedBaseUrl","baseUrl","getReactProfilingInProduction","clientResolveRewrites","resolveConfig","extensions","modules","alias","next","NEXT_PROJECT_ROOT","stream","crypto","buffer","vm","PAGES_DIR_ALIAS","DOT_NEXT_ALIAS","mainFields","terserOptions","ecma","compress","warnings","comparisons","inline","mangle","safari10","output","comments","ascii_only","isModuleCSS","type","splitChunksConfigs","cacheGroups","default","vendors","defaultVendors","prodGranular","chunks","framework","test","priority","enforce","lib","size","identifier","hash","createHash","updateHash","libIdent","update","context","digest","substring","minChunks","reuseExistingChunk","commons","shared","reduce","acc","chunk","maxInitialRequests","minSize","splitChunksConfig","crossOrigin","customAppFile","pageExtensions","conformanceConfig","ReactSyncScriptsConformanceCheck","enabled","MinificationConformanceCheck","DuplicatePolyfillsConformanceCheck","BlockedAPIToBePolyfilled","conformance","GranularChunksConformanceCheck","handleExternals","request","callback","notExternalModules","indexOf","isLocal","startsWith","posix","isAbsolute","win32","isLikelyNextExternal","res","isNextExternal","baseRes","match","externalRequest","emacsLockfilePattern","externals","optimizeCss","optimization","emitOnErrors","noEmitOnErrors","checkWasmTypes","nodeEnv","splitChunks","runtimeChunk","CLIENT_STATIC_FILES_RUNTIME_WEBPACK","minimize","minimizer","TerserPlugin","cacheDir","parallel","cpus","CssMinimizerPlugin","postcssOptions","annotation","node","setImmediate","entry","watchOptions","ignored","environment","arrowFunction","bigIntLiteral","const","destructuring","dynamicImport","forOf","filename","library","libraryTarget","hotUpdateChunkFilename","hotUpdateMainFilename","chunkFilename","strictModuleExceptionHandling","crossOriginLoading","futureEmitAssets","webassemblyModuleFilename","performance","resolveLoader","fullySpecified","include","exclude","excludePath","babelMultiThread","cacheContext","cacheDirectory","cacheIdentifier","workers","workerParallelJobs","Infinity","ReactRefreshWebpackPlugin","ProvidePlugin","Buffer","ChunkNamesPlugin","DefinePlugin","prev","key","JSON","stringify","__NEXT_TEST_MODE","trailingSlash","devIndicators","buildActivity","reactStrictMode","reactMode","optimizeFonts","optimizeImages","scrollRestoration","deviceSizes","images","imageSizes","domains","basePath","i18n","analyticsId","pageEnv","ReactLoadablePlugin","REACT_LOADABLE_MANIFEST","DropClientPage","future","excludeDefaultMomentLocales","IgnorePlugin","resourceRegExp","contextRegExp","NextJsRequireCacheHotReloader","devPlugins","HotModuleReplacementPlugin","HashedModuleIdsPlugin","ServerlessPlugin","PagesManifestPlugin","NextJsSSRModuleCachePlugin","NextJsSsrImportPlugin","BuildManifestPlugin","ProfilingPlugin","FontStylesheetGatheringPlugin","WebpackConformancePlugin","tests","AllowedSources","allowedSources","WellKnownErrorsPlugin","unshift","JsConfigPathsPlugin","providedExports","usedExports","nextPublicVariables","nextEnvVariables","configVars","assetPrefix","__NEXT_VERSION","configFile","buildDependencies","realContentHash","rootDirectory","isDevelopment","sassOptions","productionBrowserSourceMaps","originalDevtool","then","webpackDevMiddleware","canMatchCss","fileNames","input","hasUserCssConfig","oneOf","__next_css_remove","e","strictPostcssConfiguration","foundTsRule","call","isSass","source","isLess","isCss","isStylus","prototype","hasOwnProperty","correctNextCss","correctCssLoader","originalEntry","originalFile"],"mappings":"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","sourcesContent":["import { codeFrameColumns } from 'next/dist/compiled/babel/code-frame'\nimport ReactRefreshWebpackPlugin from '@next/react-refresh-utils/ReactRefreshWebpackPlugin'\nimport crypto from 'crypto'\nimport { readFileSync, realpathSync } from 'fs'\nimport chalk from 'chalk'\nimport semver from 'next/dist/compiled/semver'\n// @ts-ignore No typings yet\nimport TerserPlugin from './webpack/plugins/terser-webpack-plugin/src/index.js'\nimport path from 'path'\nimport webpack from 'webpack'\nimport { Configuration } from 'webpack'\nimport {\n  DOT_NEXT_ALIAS,\n  NEXT_PROJECT_ROOT,\n  NEXT_PROJECT_ROOT_DIST_CLIENT,\n  PAGES_DIR_ALIAS,\n} from '../lib/constants'\nimport { fileExists } from '../lib/file-exists'\nimport { getPackageVersion } from '../lib/get-package-version'\nimport { Rewrite } from '../lib/load-custom-routes'\nimport { getTypeScriptConfiguration } from '../lib/typescript/getTypeScriptConfiguration'\nimport {\n  CLIENT_STATIC_FILES_RUNTIME_MAIN,\n  CLIENT_STATIC_FILES_RUNTIME_POLYFILLS,\n  CLIENT_STATIC_FILES_RUNTIME_WEBPACK,\n  REACT_LOADABLE_MANIFEST,\n  SERVERLESS_DIRECTORY,\n  SERVER_DIRECTORY,\n} from '../next-server/lib/constants'\nimport { execOnce } from '../next-server/lib/utils'\nimport { findPageFile } from '../server/lib/find-page-file'\nimport { WebpackEntrypoints } from './entries'\nimport * as Log from './output/log'\nimport {\n  collectPlugins,\n  PluginMetaData,\n  VALID_MIDDLEWARE,\n} from './plugins/collect-plugins'\nimport { build as buildConfiguration } from './webpack/config'\nimport { __overrideCssConfiguration } from './webpack/config/blocks/css/overrideCssConfiguration'\nimport { pluginLoaderOptions } from './webpack/loaders/next-plugin-loader'\nimport BuildManifestPlugin from './webpack/plugins/build-manifest-plugin'\nimport ChunkNamesPlugin from './webpack/plugins/chunk-names-plugin'\nimport { CssMinimizerPlugin } from './webpack/plugins/css-minimizer-plugin'\nimport { JsConfigPathsPlugin } from './webpack/plugins/jsconfig-paths-plugin'\nimport { DropClientPage } from './webpack/plugins/next-drop-client-page-plugin'\nimport NextJsSsrImportPlugin from './webpack/plugins/nextjs-ssr-import'\nimport NextJsSSRModuleCachePlugin from './webpack/plugins/nextjs-ssr-module-cache'\nimport PagesManifestPlugin from './webpack/plugins/pages-manifest-plugin'\nimport { ProfilingPlugin } from './webpack/plugins/profiling-plugin'\nimport { ReactLoadablePlugin } from './webpack/plugins/react-loadable-plugin'\nimport { ServerlessPlugin } from './webpack/plugins/serverless-plugin'\nimport WebpackConformancePlugin, {\n  DuplicatePolyfillsConformanceCheck,\n  GranularChunksConformanceCheck,\n  MinificationConformanceCheck,\n  ReactSyncScriptsConformanceCheck,\n} from './webpack/plugins/webpack-conformance-plugin'\nimport { WellKnownErrorsPlugin } from './webpack/plugins/wellknown-errors-plugin'\nimport { NextConfig } from '../next-server/server/config'\n\ntype ExcludesFalse = <T>(x: T | false) => x is T\n\nconst isWebpack5 = parseInt(webpack.version!) === 5\n\nif (isWebpack5 && semver.lt(webpack.version!, '5.11.1')) {\n  Log.error(\n    `webpack 5 version must be greater than v5.11.1 to work properly with Next.js, please upgrade to continue!\\nSee more info here: https://err.sh/next.js/invalid-webpack-5-version`\n  )\n  process.exit(1)\n}\n\nconst devtoolRevertWarning = execOnce((devtool: Configuration['devtool']) => {\n  console.warn(\n    chalk.yellow.bold('Warning: ') +\n      chalk.bold(`Reverting webpack devtool to '${devtool}'.\\n`) +\n      'Changing the webpack devtool in development mode will cause severe performance regressions.\\n' +\n      'Read more: https://err.sh/next.js/improper-devtool'\n  )\n})\n\nfunction parseJsonFile(filePath: string) {\n  const JSON5 = require('next/dist/compiled/json5')\n  const contents = readFileSync(filePath, 'utf8')\n\n  // Special case an empty file\n  if (contents.trim() === '') {\n    return {}\n  }\n\n  try {\n    return JSON5.parse(contents)\n  } catch (err) {\n    const codeFrame = codeFrameColumns(\n      String(contents),\n      { start: { line: err.lineNumber, column: err.columnNumber } },\n      { message: err.message, highlightCode: true }\n    )\n    throw new Error(`Failed to parse \"${filePath}\":\\n${codeFrame}`)\n  }\n}\n\nfunction getOptimizedAliases(isServer: boolean): { [pkg: string]: string } {\n  if (isServer) {\n    return {}\n  }\n\n  const stubWindowFetch = path.join(__dirname, 'polyfills', 'fetch', 'index.js')\n  const stubObjectAssign = path.join(__dirname, 'polyfills', 'object-assign.js')\n\n  const shimAssign = path.join(__dirname, 'polyfills', 'object.assign')\n  return Object.assign(\n    {},\n    {\n      unfetch$: stubWindowFetch,\n      'isomorphic-unfetch$': stubWindowFetch,\n      'whatwg-fetch$': path.join(\n        __dirname,\n        'polyfills',\n        'fetch',\n        'whatwg-fetch.js'\n      ),\n    },\n    {\n      'object-assign$': stubObjectAssign,\n\n      // Stub Package: object.assign\n      'object.assign/auto': path.join(shimAssign, 'auto.js'),\n      'object.assign/implementation': path.join(\n        shimAssign,\n        'implementation.js'\n      ),\n      'object.assign$': path.join(shimAssign, 'index.js'),\n      'object.assign/polyfill': path.join(shimAssign, 'polyfill.js'),\n      'object.assign/shim': path.join(shimAssign, 'shim.js'),\n\n      // Replace: full URL polyfill with platform-based polyfill\n      url: require.resolve('native-url'),\n    }\n  )\n}\n\ntype ClientEntries = {\n  [key: string]: string | string[]\n}\n\nexport function attachReactRefresh(\n  webpackConfig: webpack.Configuration,\n  targetLoader: webpack.RuleSetUseItem\n) {\n  let injections = 0\n  const reactRefreshLoaderName = '@next/react-refresh-utils/loader'\n  const reactRefreshLoader = require.resolve(reactRefreshLoaderName)\n  webpackConfig.module?.rules.forEach((rule) => {\n    const curr = rule.use\n    // When the user has configured `defaultLoaders.babel` for a input file:\n    if (curr === targetLoader) {\n      ++injections\n      rule.use = [reactRefreshLoader, curr as webpack.RuleSetUseItem]\n    } else if (\n      Array.isArray(curr) &&\n      curr.some((r) => r === targetLoader) &&\n      // Check if loader already exists:\n      !curr.some(\n        (r) => r === reactRefreshLoader || r === reactRefreshLoaderName\n      )\n    ) {\n      ++injections\n      const idx = curr.findIndex((r) => r === targetLoader)\n      // Clone to not mutate user input\n      rule.use = [...curr]\n\n      // inject / input: [other, babel] output: [other, refresh, babel]:\n      rule.use.splice(idx, 0, reactRefreshLoader)\n    }\n  })\n\n  if (injections) {\n    Log.info(\n      `automatically enabled Fast Refresh for ${injections} custom loader${\n        injections > 1 ? 's' : ''\n      }`\n    )\n  }\n}\n\nexport default async function getBaseWebpackConfig(\n  dir: string,\n  {\n    buildId,\n    config,\n    dev = false,\n    isServer = false,\n    pagesDir,\n    target = 'server',\n    reactProductionProfiling = false,\n    entrypoints,\n    rewrites,\n  }: {\n    buildId: string\n    config: NextConfig\n    dev?: boolean\n    isServer?: boolean\n    pagesDir: string\n    target?: string\n    reactProductionProfiling?: boolean\n    entrypoints: WebpackEntrypoints\n    rewrites: Rewrite[]\n  }\n): Promise<webpack.Configuration> {\n  let plugins: PluginMetaData[] = []\n  let babelPresetPlugins: { dir: string; config: any }[] = []\n\n  const hasRewrites = rewrites.length > 0 || dev\n\n  if (config.experimental.plugins) {\n    plugins = await collectPlugins(dir, config.env, config.plugins)\n    pluginLoaderOptions.plugins = plugins\n\n    for (const plugin of plugins) {\n      if (plugin.middleware.includes('babel-preset-build')) {\n        babelPresetPlugins.push({\n          dir: plugin.directory,\n          config: plugin.config,\n        })\n      }\n    }\n  }\n\n  const reactVersion = await getPackageVersion({ cwd: dir, name: 'react' })\n  const hasReactRefresh: boolean = dev && !isServer\n  const hasJsxRuntime: boolean =\n    Boolean(reactVersion) &&\n    // 17.0.0-rc.0 had a breaking change not compatible with Next.js, but was\n    // fixed in rc.1.\n    semver.gte(reactVersion!, '17.0.0-rc.1')\n\n  const distDir = path.join(dir, config.distDir)\n  const defaultLoaders = {\n    babel: {\n      loader: 'next-babel-loader',\n      options: {\n        isServer,\n        distDir,\n        pagesDir,\n        cwd: dir,\n        // Webpack 5 has a built-in loader cache\n        cache: !isWebpack5,\n        babelPresetPlugins,\n        development: dev,\n        hasReactRefresh,\n        hasJsxRuntime,\n      },\n    },\n    // Backwards compat\n    hotSelfAccept: {\n      loader: 'noop-loader',\n    },\n  }\n\n  const babelIncludeRegexes: RegExp[] = [\n    /next[\\\\/]dist[\\\\/]next-server[\\\\/]lib/,\n    /next[\\\\/]dist[\\\\/]client/,\n    /next[\\\\/]dist[\\\\/]pages/,\n    /[\\\\/](strip-ansi|ansi-regex)[\\\\/]/,\n    ...(config.experimental.plugins\n      ? VALID_MIDDLEWARE.map((name) => new RegExp(`src(\\\\\\\\|/)${name}`))\n      : []),\n  ]\n\n  // Support for NODE_PATH\n  const nodePathList = (process.env.NODE_PATH || '')\n    .split(process.platform === 'win32' ? ';' : ':')\n    .filter((p) => !!p)\n\n  const isServerless = target === 'serverless'\n  const isServerlessTrace = target === 'experimental-serverless-trace'\n  // Intentionally not using isTargetLikeServerless helper\n  const isLikeServerless = isServerless || isServerlessTrace\n\n  const outputDir = isLikeServerless ? SERVERLESS_DIRECTORY : SERVER_DIRECTORY\n  const outputPath = path.join(distDir, isServer ? outputDir : '')\n  const totalPages = Object.keys(entrypoints).length\n  const clientEntries = !isServer\n    ? ({\n        // Backwards compatibility\n        'main.js': [],\n        [CLIENT_STATIC_FILES_RUNTIME_MAIN]:\n          `./` +\n          path\n            .relative(\n              dir,\n              path.join(\n                NEXT_PROJECT_ROOT_DIST_CLIENT,\n                dev ? `next-dev.js` : 'next.js'\n              )\n            )\n            .replace(/\\\\/g, '/'),\n        [CLIENT_STATIC_FILES_RUNTIME_POLYFILLS]: path.join(\n          NEXT_PROJECT_ROOT_DIST_CLIENT,\n          'polyfills.js'\n        ),\n      } as ClientEntries)\n    : undefined\n\n  let typeScriptPath: string | undefined\n  try {\n    typeScriptPath = require.resolve('typescript', { paths: [dir] })\n  } catch (_) {}\n  const tsConfigPath = path.join(dir, 'tsconfig.json')\n  const useTypeScript = Boolean(\n    typeScriptPath && (await fileExists(tsConfigPath))\n  )\n\n  let jsConfig\n  // jsconfig is a subset of tsconfig\n  if (useTypeScript) {\n    const ts = (await import(typeScriptPath!)) as typeof import('typescript')\n    const tsConfig = await getTypeScriptConfiguration(ts, tsConfigPath)\n    jsConfig = { compilerOptions: tsConfig.options }\n  }\n\n  const jsConfigPath = path.join(dir, 'jsconfig.json')\n  if (!useTypeScript && (await fileExists(jsConfigPath))) {\n    jsConfig = parseJsonFile(jsConfigPath)\n  }\n\n  let resolvedBaseUrl\n  if (jsConfig?.compilerOptions?.baseUrl) {\n    resolvedBaseUrl = path.resolve(dir, jsConfig.compilerOptions.baseUrl)\n  }\n\n  function getReactProfilingInProduction() {\n    if (reactProductionProfiling) {\n      return {\n        'react-dom$': 'react-dom/profiling',\n        'scheduler/tracing': 'scheduler/tracing-profiling',\n      }\n    }\n  }\n\n  const clientResolveRewrites = require.resolve(\n    'next/dist/next-server/lib/router/utils/resolve-rewrites'\n  )\n\n  const resolveConfig = {\n    // Disable .mjs for node_modules bundling\n    extensions: isServer\n      ? [\n          '.js',\n          '.mjs',\n          ...(useTypeScript ? ['.tsx', '.ts'] : []),\n          '.jsx',\n          '.json',\n          '.wasm',\n        ]\n      : [\n          '.mjs',\n          '.js',\n          ...(useTypeScript ? ['.tsx', '.ts'] : []),\n          '.jsx',\n          '.json',\n          '.wasm',\n        ],\n    modules: [\n      'node_modules',\n      ...nodePathList, // Support for NODE_PATH environment variable\n    ],\n    alias: {\n      next: NEXT_PROJECT_ROOT,\n      ...(isWebpack5 && !isServer\n        ? {\n            stream: require.resolve('stream-browserify'),\n            path: require.resolve('path-browserify'),\n            crypto: require.resolve('crypto-browserify'),\n            buffer: require.resolve('buffer'),\n            vm: require.resolve('vm-browserify'),\n          }\n        : undefined),\n      [PAGES_DIR_ALIAS]: pagesDir,\n      [DOT_NEXT_ALIAS]: distDir,\n      ...getOptimizedAliases(isServer),\n      ...getReactProfilingInProduction(),\n      [clientResolveRewrites]: hasRewrites\n        ? clientResolveRewrites\n        : require.resolve('next/dist/client/dev/noop.js'),\n    },\n    mainFields: isServer ? ['main', 'module'] : ['browser', 'module', 'main'],\n    plugins: isWebpack5\n      ? // webpack 5+ has the PnP resolver built-in by default:\n        []\n      : [require('pnp-webpack-plugin')],\n  }\n\n  const terserOptions: any = {\n    parse: {\n      ecma: 8,\n    },\n    compress: {\n      ecma: 5,\n      warnings: false,\n      // The following two options are known to break valid JavaScript code\n      comparisons: false,\n      inline: 2, // https://github.com/vercel/next.js/issues/7178#issuecomment-493048965\n    },\n    mangle: { safari10: true },\n    output: {\n      ecma: 5,\n      safari10: true,\n      comments: false,\n      // Fixes usage of Emoji and certain Regex\n      ascii_only: true,\n    },\n  }\n\n  const isModuleCSS = (module: { type: string }): boolean => {\n    return (\n      // mini-css-extract-plugin\n      module.type === `css/mini-extract` ||\n      // extract-css-chunks-webpack-plugin (old)\n      module.type === `css/extract-chunks` ||\n      // extract-css-chunks-webpack-plugin (new)\n      module.type === `css/extract-css-chunks`\n    )\n  }\n\n  // Contains various versions of the Webpack SplitChunksPlugin used in different build types\n  const splitChunksConfigs: {\n    [propName: string]: webpack.Options.SplitChunksOptions\n  } = {\n    dev: {\n      cacheGroups: {\n        default: false,\n        vendors: false,\n        // In webpack 5 vendors was renamed to defaultVendors\n        defaultVendors: false,\n      },\n    },\n    prodGranular: {\n      chunks: 'all',\n      cacheGroups: {\n        default: false,\n        vendors: false,\n        // In webpack 5 vendors was renamed to defaultVendors\n        defaultVendors: false,\n        framework: {\n          chunks: 'all',\n          name: 'framework',\n          // This regex ignores nested copies of framework libraries so they're\n          // bundled with their issuer.\n          // https://github.com/vercel/next.js/pull/9012\n          test: /(?<!node_modules.*)[\\\\/]node_modules[\\\\/](react|react-dom|scheduler|prop-types|use-subscription)[\\\\/]/,\n          priority: 40,\n          // Don't let webpack eliminate this chunk (prevents this chunk from\n          // becoming a part of the commons chunk)\n          enforce: true,\n        },\n        lib: {\n          test(module: { size: Function; identifier: Function }): boolean {\n            return (\n              module.size() > 160000 &&\n              /node_modules[/\\\\]/.test(module.identifier())\n            )\n          },\n          name(module: {\n            type: string\n            libIdent?: Function\n            updateHash: (hash: crypto.Hash) => void\n          }): string {\n            const hash = crypto.createHash('sha1')\n            if (isModuleCSS(module)) {\n              module.updateHash(hash)\n            } else {\n              if (!module.libIdent) {\n                throw new Error(\n                  `Encountered unknown module type: ${module.type}. Please open an issue.`\n                )\n              }\n\n              hash.update(module.libIdent({ context: dir }))\n            }\n\n            return hash.digest('hex').substring(0, 8)\n          },\n          priority: 30,\n          minChunks: 1,\n          reuseExistingChunk: true,\n        },\n        commons: {\n          name: 'commons',\n          minChunks: totalPages,\n          priority: 20,\n        },\n        shared: {\n          name(module, chunks) {\n            return (\n              crypto\n                .createHash('sha1')\n                .update(\n                  chunks.reduce(\n                    (acc: string, chunk: webpack.compilation.Chunk) => {\n                      return acc + chunk.name\n                    },\n                    ''\n                  )\n                )\n                .digest('hex') + (isModuleCSS(module) ? '_CSS' : '')\n            )\n          },\n          priority: 10,\n          minChunks: 2,\n          reuseExistingChunk: true,\n        },\n      },\n      maxInitialRequests: 25,\n      minSize: 20000,\n    },\n  }\n\n  // Select appropriate SplitChunksPlugin config for this build\n  let splitChunksConfig: webpack.Options.SplitChunksOptions\n  if (dev) {\n    splitChunksConfig = splitChunksConfigs.dev\n  } else {\n    splitChunksConfig = splitChunksConfigs.prodGranular\n  }\n\n  const crossOrigin = config.crossOrigin\n\n  let customAppFile: string | null = await findPageFile(\n    pagesDir,\n    '/_app',\n    config.pageExtensions\n  )\n  if (customAppFile) {\n    customAppFile = path.resolve(path.join(pagesDir, customAppFile))\n  }\n\n  const conformanceConfig = Object.assign(\n    {\n      ReactSyncScriptsConformanceCheck: {\n        enabled: true,\n      },\n      MinificationConformanceCheck: {\n        enabled: true,\n      },\n      DuplicatePolyfillsConformanceCheck: {\n        enabled: true,\n        BlockedAPIToBePolyfilled: Object.assign(\n          [],\n          ['fetch'],\n          config.conformance?.DuplicatePolyfillsConformanceCheck\n            ?.BlockedAPIToBePolyfilled || []\n        ),\n      },\n      GranularChunksConformanceCheck: {\n        enabled: true,\n      },\n    },\n    config.conformance\n  )\n\n  function handleExternals(context: any, request: any, callback: any) {\n    if (request === 'next') {\n      return callback(undefined, `commonjs ${request}`)\n    }\n\n    const notExternalModules = [\n      'next/app',\n      'next/document',\n      'next/link',\n      'next/image',\n      'next/error',\n      'string-hash',\n      'next/constants',\n    ]\n\n    if (notExternalModules.indexOf(request) !== -1) {\n      return callback()\n    }\n\n    // We need to externalize internal requests for files intended to\n    // not be bundled.\n\n    const isLocal: boolean =\n      request.startsWith('.') ||\n      // Always check for unix-style path, as webpack sometimes\n      // normalizes as posix.\n      path.posix.isAbsolute(request) ||\n      // When on Windows, we also want to check for Windows-specific\n      // absolute paths.\n      (process.platform === 'win32' && path.win32.isAbsolute(request))\n    const isLikelyNextExternal =\n      isLocal && /[/\\\\]next-server[/\\\\]/.test(request)\n\n    // Relative requires don't need custom resolution, because they\n    // are relative to requests we've already resolved here.\n    // Absolute requires (require('/foo')) are extremely uncommon, but\n    // also have no need for customization as they're already resolved.\n    if (isLocal && !isLikelyNextExternal) {\n      return callback()\n    }\n\n    // Resolve the import with the webpack provided context, this\n    // ensures we're resolving the correct version when multiple\n    // exist.\n    let res: string\n    try {\n      res = require.resolve(request, { paths: [context] })\n    } catch (err) {\n      // If the request cannot be resolved, we need to tell webpack to\n      // \"bundle\" it so that webpack shows an error (that it cannot be\n      // resolved).\n      return callback()\n    }\n\n    // Same as above, if the request cannot be resolved we need to have\n    // webpack \"bundle\" it so it surfaces the not found error.\n    if (!res) {\n      return callback()\n    }\n\n    let isNextExternal: boolean = false\n    if (isLocal) {\n      // we need to process next-server/lib/router/router so that\n      // the DefinePlugin can inject process.env values\n      isNextExternal = /next[/\\\\]dist[/\\\\]next-server[/\\\\](?!lib[/\\\\]router[/\\\\]router)/.test(\n        res\n      )\n\n      if (!isNextExternal) {\n        return callback()\n      }\n    }\n\n    // `isNextExternal` special cases Next.js' internal requires that\n    // should not be bundled. We need to skip the base resolve routine\n    // to prevent it from being bundled (assumes Next.js version cannot\n    // mismatch).\n    if (!isNextExternal) {\n      // Bundled Node.js code is relocated without its node_modules tree.\n      // This means we need to make sure its request resolves to the same\n      // package that'll be available at runtime. If it's not identical,\n      // we need to bundle the code (even if it _should_ be external).\n      let baseRes: string | null\n      try {\n        baseRes = require.resolve(request, { paths: [dir] })\n      } catch (err) {\n        baseRes = null\n      }\n\n      // Same as above: if the package, when required from the root,\n      // would be different from what the real resolution would use, we\n      // cannot externalize it.\n      if (\n        !baseRes ||\n        (baseRes !== res &&\n          // if res and baseRes are symlinks they could point to the the same file\n          realpathSync(baseRes) !== realpathSync(res))\n      ) {\n        return callback()\n      }\n    }\n\n    // Default pages have to be transpiled\n    if (\n      !res.match(/next[/\\\\]dist[/\\\\]next-server[/\\\\]/) &&\n      (res.match(/[/\\\\]next[/\\\\]dist[/\\\\]/) ||\n        // This is the @babel/plugin-transform-runtime \"helpers: true\" option\n        res.match(/node_modules[/\\\\]@babel[/\\\\]runtime[/\\\\]/))\n    ) {\n      return callback()\n    }\n\n    // Webpack itself has to be compiled because it doesn't always use module relative paths\n    if (\n      res.match(/node_modules[/\\\\]webpack/) ||\n      res.match(/node_modules[/\\\\]css-loader/)\n    ) {\n      return callback()\n    }\n\n    // Anything else that is standard JavaScript within `node_modules`\n    // can be externalized.\n    if (isNextExternal || res.match(/node_modules[/\\\\].*\\.js$/)) {\n      const externalRequest = isNextExternal\n        ? // Generate Next.js external import\n          path.posix.join(\n            'next',\n            'dist',\n            path\n              .relative(\n                // Root of Next.js package:\n                path.join(__dirname, '..'),\n                res\n              )\n              // Windows path normalization\n              .replace(/\\\\/g, '/')\n          )\n        : request\n\n      return callback(undefined, `commonjs ${externalRequest}`)\n    }\n\n    // Default behavior: bundle the code!\n    callback()\n  }\n\n  const emacsLockfilePattern = '**/.#*'\n\n  let webpackConfig: webpack.Configuration = {\n    externals: !isServer\n      ? // make sure importing \"next\" is handled gracefully for client\n        // bundles in case a user imported types and it wasn't removed\n        // TODO: should we warn/error for this instead?\n        ['next']\n      : !isServerless\n      ? [\n          isWebpack5\n            ? ({ context, request }, callback) =>\n                handleExternals(context, request, callback)\n            : (context, request, callback) =>\n                handleExternals(context, request, callback),\n        ]\n      : [\n          // When the 'serverless' target is used all node_modules will be compiled into the output bundles\n          // So that the 'serverless' bundles have 0 runtime dependencies\n          '@ampproject/toolbox-optimizer', // except this one\n\n          // Mark this as external if not enabled so it doesn't cause a\n          // webpack error from being missing\n          ...(config.experimental.optimizeCss ? [] : ['critters']),\n        ],\n    optimization: {\n      // Webpack 5 uses a new property for the same functionality\n      ...(isWebpack5 ? { emitOnErrors: !dev } : { noEmitOnErrors: dev }),\n      checkWasmTypes: false,\n      nodeEnv: false,\n      splitChunks: isServer ? false : splitChunksConfig,\n      runtimeChunk: isServer\n        ? isWebpack5 && !isLikeServerless\n          ? { name: 'webpack-runtime' }\n          : undefined\n        : { name: CLIENT_STATIC_FILES_RUNTIME_WEBPACK },\n      minimize: !(dev || isServer),\n      minimizer: [\n        // Minify JavaScript\n        new TerserPlugin({\n          cacheDir: path.join(distDir, 'cache', 'next-minifier'),\n          parallel: config.experimental.cpus,\n          terserOptions,\n        }),\n        // Minify CSS\n        new CssMinimizerPlugin({\n          postcssOptions: {\n            map: {\n              // `inline: false` generates the source map in a separate file.\n              // Otherwise, the CSS file is needlessly large.\n              inline: false,\n              // `annotation: false` skips appending the `sourceMappingURL`\n              // to the end of the CSS file. Webpack already handles this.\n              annotation: false,\n            },\n          },\n        }),\n      ],\n    },\n    context: dir,\n    node: {\n      setImmediate: false,\n    },\n    // Kept as function to be backwards compatible\n    entry: async () => {\n      return {\n        ...(clientEntries ? clientEntries : {}),\n        ...entrypoints,\n        ...(isServer\n          ? {\n              'init-server.js': 'next-plugin-loader?middleware=on-init-server!',\n              'on-error-server.js':\n                'next-plugin-loader?middleware=on-error-server!',\n            }\n          : {}),\n      }\n    },\n    watchOptions: {\n      ignored: [\n        '**/.git/**',\n        '**/node_modules/**',\n        '**/.next/**',\n        // can be removed after https://github.com/paulmillr/chokidar/issues/955 is released\n        emacsLockfilePattern,\n      ],\n    },\n    output: {\n      ...(isWebpack5\n        ? {\n            environment: {\n              arrowFunction: false,\n              bigIntLiteral: false,\n              const: false,\n              destructuring: false,\n              dynamicImport: false,\n              forOf: false,\n              module: false,\n            },\n          }\n        : {}),\n      path: outputPath,\n      // On the server we don't use the chunkhash\n      filename: isServer\n        ? '[name].js'\n        : `static/chunks/[name]${dev ? '' : '-[chunkhash]'}.js`,\n      library: isServer ? undefined : '_N_E',\n      libraryTarget: isServer ? 'commonjs2' : 'assign',\n      hotUpdateChunkFilename: isWebpack5\n        ? 'static/webpack/[id].[fullhash].hot-update.js'\n        : 'static/webpack/[id].[hash].hot-update.js',\n      hotUpdateMainFilename: isWebpack5\n        ? 'static/webpack/[fullhash].hot-update.json'\n        : 'static/webpack/[hash].hot-update.json',\n      // This saves chunks with the name given via `import()`\n      chunkFilename: isServer\n        ? `${dev ? '[name]' : '[name].[contenthash]'}.js`\n        : `static/chunks/${dev ? '[name]' : '[name].[contenthash]'}.js`,\n      strictModuleExceptionHandling: true,\n      crossOriginLoading: crossOrigin,\n      futureEmitAssets: !dev,\n      webassemblyModuleFilename: 'static/wasm/[modulehash].wasm',\n    },\n    performance: false,\n    resolve: resolveConfig,\n    resolveLoader: {\n      // The loaders Next.js provides\n      alias: [\n        'emit-file-loader',\n        'error-loader',\n        'next-babel-loader',\n        'next-client-pages-loader',\n        'next-serverless-loader',\n        'noop-loader',\n        'next-plugin-loader',\n      ].reduce((alias, loader) => {\n        // using multiple aliases to replace `resolveLoader.modules`\n        alias[loader] = path.join(__dirname, 'webpack', 'loaders', loader)\n\n        return alias\n      }, {} as Record<string, string>),\n      modules: [\n        'node_modules',\n        ...nodePathList, // Support for NODE_PATH environment variable\n      ],\n      plugins: isWebpack5 ? [] : [require('pnp-webpack-plugin')],\n    },\n    module: {\n      rules: [\n        ...(isWebpack5\n          ? [\n              // TODO: FIXME: do NOT webpack 5 support with this\n              // x-ref: https://github.com/webpack/webpack/issues/11467\n              {\n                test: /\\.m?js/,\n                resolve: {\n                  fullySpecified: false,\n                },\n              } as any,\n            ]\n          : []),\n        {\n          test: /\\.(tsx|ts|js|mjs|jsx)$/,\n          include: [dir, ...babelIncludeRegexes],\n          exclude: (excludePath: string) => {\n            if (babelIncludeRegexes.some((r) => r.test(excludePath))) {\n              return false\n            }\n            return /node_modules/.test(excludePath)\n          },\n          use: config.experimental.babelMultiThread\n            ? [\n                // Move Babel transpilation into a thread pool (2 workers, unlimited batch size).\n                // Applying a cache to the off-thread work avoids paying transfer costs for unchanged modules.\n                {\n                  loader: 'next/dist/compiled/cache-loader',\n                  options: {\n                    cacheContext: dir,\n                    cacheDirectory: path.join(dir, '.next', 'cache', 'webpack'),\n                    cacheIdentifier: `webpack${isServer ? '-server' : ''}`,\n                  },\n                },\n                {\n                  loader: require.resolve('next/dist/compiled/thread-loader'),\n                  options: {\n                    workers: 2,\n                    workerParallelJobs: Infinity,\n                  },\n                },\n                hasReactRefresh\n                  ? require.resolve('@next/react-refresh-utils/loader')\n                  : '',\n                defaultLoaders.babel,\n              ].filter(Boolean)\n            : hasReactRefresh\n            ? [\n                require.resolve('@next/react-refresh-utils/loader'),\n                defaultLoaders.babel,\n              ]\n            : defaultLoaders.babel,\n        },\n      ].filter(Boolean),\n    },\n    plugins: [\n      hasReactRefresh && new ReactRefreshWebpackPlugin(),\n      // Makes sure `Buffer` and `process` are polyfilled in client-side bundles (same behavior as webpack 4)\n      isWebpack5 &&\n        !isServer &&\n        new webpack.ProvidePlugin({\n          Buffer: [require.resolve('buffer'), 'Buffer'],\n          process: [require.resolve('process')],\n        }),\n      // This plugin makes sure `output.filename` is used for entry chunks\n      !isWebpack5 && new ChunkNamesPlugin(),\n      new webpack.DefinePlugin({\n        ...Object.keys(process.env).reduce(\n          (prev: { [key: string]: string }, key: string) => {\n            if (key.startsWith('NEXT_PUBLIC_')) {\n              prev[`process.env.${key}`] = JSON.stringify(process.env[key]!)\n            }\n            return prev\n          },\n          {}\n        ),\n        ...Object.keys(config.env).reduce((acc, key) => {\n          if (/^(?:NODE_.+)|^(?:__.+)$/i.test(key)) {\n            throw new Error(\n              `The key \"${key}\" under \"env\" in next.config.js is not allowed. https://err.sh/vercel/next.js/env-key-not-allowed`\n            )\n          }\n\n          return {\n            ...acc,\n            [`process.env.${key}`]: JSON.stringify(config.env[key]),\n          }\n        }, {}),\n        // TODO: enforce `NODE_ENV` on `process.env`, and add a test:\n        'process.env.NODE_ENV': JSON.stringify(\n          dev ? 'development' : 'production'\n        ),\n        'process.env.__NEXT_CROSS_ORIGIN': JSON.stringify(crossOrigin),\n        'process.browser': JSON.stringify(!isServer),\n        'process.env.__NEXT_TEST_MODE': JSON.stringify(\n          process.env.__NEXT_TEST_MODE\n        ),\n        // This is used in client/dev-error-overlay/hot-dev-client.js to replace the dist directory\n        ...(dev && !isServer\n          ? {\n              'process.env.__NEXT_DIST_DIR': JSON.stringify(distDir),\n            }\n          : {}),\n        'process.env.__NEXT_TRAILING_SLASH': JSON.stringify(\n          config.trailingSlash\n        ),\n        'process.env.__NEXT_BUILD_INDICATOR': JSON.stringify(\n          config.devIndicators.buildActivity\n        ),\n        'process.env.__NEXT_PLUGINS': JSON.stringify(\n          config.experimental.plugins\n        ),\n        'process.env.__NEXT_STRICT_MODE': JSON.stringify(\n          config.reactStrictMode\n        ),\n        'process.env.__NEXT_REACT_MODE': JSON.stringify(\n          config.experimental.reactMode\n        ),\n        'process.env.__NEXT_OPTIMIZE_FONTS': JSON.stringify(\n          config.experimental.optimizeFonts && !dev\n        ),\n        'process.env.__NEXT_OPTIMIZE_IMAGES': JSON.stringify(\n          config.experimental.optimizeImages\n        ),\n        'process.env.__NEXT_OPTIMIZE_CSS': JSON.stringify(\n          !!config.experimental.optimizeCss && !dev\n        ),\n        'process.env.__NEXT_SCROLL_RESTORATION': JSON.stringify(\n          config.experimental.scrollRestoration\n        ),\n        'process.env.__NEXT_IMAGE_OPTS': JSON.stringify({\n          deviceSizes: config.images.deviceSizes,\n          imageSizes: config.images.imageSizes,\n          path: config.images.path,\n          loader: config.images.loader,\n          ...(dev\n            ? {\n                // pass domains in development to allow validating on the client\n                domains: config.images.domains,\n              }\n            : {}),\n        }),\n        'process.env.__NEXT_ROUTER_BASEPATH': JSON.stringify(config.basePath),\n        'process.env.__NEXT_HAS_REWRITES': JSON.stringify(hasRewrites),\n        'process.env.__NEXT_I18N_SUPPORT': JSON.stringify(!!config.i18n),\n        'process.env.__NEXT_I18N_DOMAINS': JSON.stringify(config.i18n?.domains),\n        'process.env.__NEXT_ANALYTICS_ID': JSON.stringify(config.analyticsId),\n        ...(isServer\n          ? {\n              // Fix bad-actors in the npm ecosystem (e.g. `node-formidable`)\n              // This is typically found in unmaintained modules from the\n              // pre-webpack era (common in server-side code)\n              'global.GENTLY': JSON.stringify(false),\n            }\n          : undefined),\n        // stub process.env with proxy to warn a missing value is\n        // being accessed in development mode\n        ...(config.experimental.pageEnv && dev\n          ? {\n              'process.env': `\n            new Proxy(${isServer ? 'process.env' : '{}'}, {\n              get(target, prop) {\n                if (typeof target[prop] === 'undefined') {\n                  console.warn(\\`An environment variable (\\${prop}) that was not provided in the environment was accessed.\\nSee more info here: https://err.sh/next.js/missing-env-value\\`)\n                }\n                return target[prop]\n              }\n            })\n          `,\n            }\n          : {}),\n      }),\n      !isServer &&\n        new ReactLoadablePlugin({\n          filename: REACT_LOADABLE_MANIFEST,\n        }),\n      !isServer && new DropClientPage(),\n      // Moment.js is an extremely popular library that bundles large locale files\n      // by default due to how Webpack interprets its code. This is a practical\n      // solution that requires the user to opt into importing specific locales.\n      // https://github.com/jmblog/how-to-optimize-momentjs-with-webpack\n      config.future.excludeDefaultMomentLocales &&\n        new webpack.IgnorePlugin({\n          resourceRegExp: /^\\.\\/locale$/,\n          contextRegExp: /moment$/,\n        }),\n      ...(dev\n        ? (() => {\n            // Even though require.cache is server only we have to clear assets from both compilations\n            // This is because the client compilation generates the build manifest that's used on the server side\n            const {\n              NextJsRequireCacheHotReloader,\n            } = require('./webpack/plugins/nextjs-require-cache-hot-reloader')\n            const devPlugins = [new NextJsRequireCacheHotReloader()]\n\n            if (!isServer) {\n              devPlugins.push(new webpack.HotModuleReplacementPlugin())\n            }\n\n            return devPlugins\n          })()\n        : []),\n      // Webpack 5 no longer requires this plugin in production:\n      !isWebpack5 && !dev && new webpack.HashedModuleIdsPlugin(),\n      !dev &&\n        new webpack.IgnorePlugin({\n          resourceRegExp: /react-is/,\n          contextRegExp: /(next-server|next)[\\\\/]dist[\\\\/]/,\n        }),\n      isServerless && isServer && new ServerlessPlugin(),\n      isServer && new PagesManifestPlugin(isLikeServerless),\n      !isWebpack5 &&\n        target === 'server' &&\n        isServer &&\n        new NextJsSSRModuleCachePlugin({ outputPath }),\n      isServer && new NextJsSsrImportPlugin(),\n      !isServer &&\n        new BuildManifestPlugin({\n          buildId,\n          rewrites,\n        }),\n      new ProfilingPlugin(),\n      config.experimental.optimizeFonts &&\n        !dev &&\n        isServer &&\n        (function () {\n          const {\n            FontStylesheetGatheringPlugin,\n          } = require('./webpack/plugins/font-stylesheet-gathering-plugin')\n          return new FontStylesheetGatheringPlugin()\n        })(),\n      config.experimental.conformance &&\n        !isWebpack5 &&\n        !dev &&\n        new WebpackConformancePlugin({\n          tests: [\n            !isServer &&\n              conformanceConfig.MinificationConformanceCheck.enabled &&\n              new MinificationConformanceCheck(),\n            conformanceConfig.ReactSyncScriptsConformanceCheck.enabled &&\n              new ReactSyncScriptsConformanceCheck({\n                AllowedSources:\n                  conformanceConfig.ReactSyncScriptsConformanceCheck\n                    .allowedSources || [],\n              }),\n            !isServer &&\n              conformanceConfig.DuplicatePolyfillsConformanceCheck.enabled &&\n              new DuplicatePolyfillsConformanceCheck({\n                BlockedAPIToBePolyfilled:\n                  conformanceConfig.DuplicatePolyfillsConformanceCheck\n                    .BlockedAPIToBePolyfilled,\n              }),\n            !isServer &&\n              conformanceConfig.GranularChunksConformanceCheck.enabled &&\n              new GranularChunksConformanceCheck(\n                splitChunksConfigs.prodGranular\n              ),\n          ].filter(Boolean),\n        }),\n      new WellKnownErrorsPlugin(),\n    ].filter((Boolean as any) as ExcludesFalse),\n  }\n\n  // Support tsconfig and jsconfig baseUrl\n  if (resolvedBaseUrl) {\n    webpackConfig.resolve?.modules?.push(resolvedBaseUrl)\n  }\n\n  if (jsConfig?.compilerOptions?.paths && resolvedBaseUrl) {\n    webpackConfig.resolve?.plugins?.unshift(\n      new JsConfigPathsPlugin(jsConfig.compilerOptions.paths, resolvedBaseUrl)\n    )\n  }\n\n  if (isWebpack5) {\n    // futureEmitAssets is on by default in webpack 5\n    delete webpackConfig.output?.futureEmitAssets\n    // webpack 5 no longer polyfills Node.js modules:\n    if (webpackConfig.node) delete webpackConfig.node.setImmediate\n\n    if (dev) {\n      if (!webpackConfig.optimization) {\n        webpackConfig.optimization = {}\n      }\n      webpackConfig.optimization.providedExports = false\n      webpackConfig.optimization.usedExports = false\n    }\n\n    const nextPublicVariables = Object.keys(process.env)\n      .reduce((acc: string[], key: string) => {\n        if (key.startsWith('NEXT_PUBLIC_')) {\n          return [...acc, `${key}=${process.env[key]}`]\n        }\n        return acc\n      }, [])\n      .join('|')\n\n    const nextEnvVariables = Object.keys(config.env).reduce(\n      (prev: string, key: string) => {\n        return `${prev}|${key}=${config.env[key]}`\n      },\n      ''\n    )\n\n    const configVars = JSON.stringify({\n      crossOrigin: config.crossOrigin,\n      pageExtensions: config.pageExtensions,\n      trailingSlash: config.trailingSlash,\n      buildActivity: config.devIndicators.buildActivity,\n      plugins: config.experimental.plugins,\n      reactStrictMode: config.reactStrictMode,\n      reactMode: config.experimental.reactMode,\n      optimizeFonts: config.experimental.optimizeFonts,\n      optimizeImages: config.experimental.optimizeImages,\n      scrollRestoration: config.experimental.scrollRestoration,\n      basePath: config.basePath,\n      pageEnv: config.experimental.pageEnv,\n      excludeDefaultMomentLocales: config.future.excludeDefaultMomentLocales,\n      assetPrefix: config.assetPrefix,\n      target,\n      reactProductionProfiling,\n    })\n\n    const cache: any = {\n      type: 'filesystem',\n      // Includes:\n      //  - Next.js version\n      //  - NEXT_PUBLIC_ variable values (they affect caching) TODO: make this module usage only\n      //  - next.config.js `env` key\n      //  - next.config.js keys that affect compilation\n      version: `${process.env.__NEXT_VERSION}|${nextPublicVariables}|${nextEnvVariables}|${configVars}`,\n      cacheDirectory: path.join(dir, '.next', 'cache', 'webpack'),\n    }\n\n    // Adds `next.config.js` as a buildDependency when custom webpack config is provided\n    if (config.webpack && config.configFile) {\n      cache.buildDependencies = {\n        config: [config.configFile],\n      }\n    }\n\n    webpackConfig.cache = cache\n\n    // @ts-ignore TODO: remove ignore when webpack 5 is stable\n    webpackConfig.optimization.realContentHash = false\n  }\n\n  webpackConfig = await buildConfiguration(webpackConfig, {\n    rootDirectory: dir,\n    customAppFile,\n    isDevelopment: dev,\n    isServer,\n    assetPrefix: config.assetPrefix || '',\n    sassOptions: config.sassOptions,\n    productionBrowserSourceMaps: config.productionBrowserSourceMaps,\n    future: config.future,\n  })\n\n  let originalDevtool = webpackConfig.devtool\n  if (typeof config.webpack === 'function') {\n    webpackConfig = config.webpack(webpackConfig, {\n      dir,\n      dev,\n      isServer,\n      buildId,\n      config,\n      defaultLoaders,\n      totalPages,\n      webpack,\n    })\n\n    if (!webpackConfig) {\n      throw new Error(\n        'Webpack config is undefined. You may have forgot to return properly from within the \"webpack\" method of your next.config.js.\\n' +\n          'See more info here https://err.sh/next.js/undefined-webpack-config'\n      )\n    }\n\n    if (dev && originalDevtool !== webpackConfig.devtool) {\n      webpackConfig.devtool = originalDevtool\n      devtoolRevertWarning(originalDevtool)\n    }\n\n    if (typeof (webpackConfig as any).then === 'function') {\n      console.warn(\n        '> Promise returned in next config. https://err.sh/vercel/next.js/promise-in-next-config'\n      )\n    }\n  }\n\n  // Backwards compat with webpack-dev-middleware options object\n  if (typeof config.webpackDevMiddleware === 'function') {\n    const options = config.webpackDevMiddleware({\n      watchOptions: webpackConfig.watchOptions,\n    })\n    if (options.watchOptions) {\n      webpackConfig.watchOptions = options.watchOptions\n    }\n  }\n\n  function canMatchCss(rule: webpack.RuleSetCondition | undefined): boolean {\n    if (!rule) {\n      return false\n    }\n\n    const fileNames = [\n      '/tmp/test.css',\n      '/tmp/test.scss',\n      '/tmp/test.sass',\n      '/tmp/test.less',\n      '/tmp/test.styl',\n    ]\n\n    if (rule instanceof RegExp && fileNames.some((input) => rule.test(input))) {\n      return true\n    }\n\n    if (typeof rule === 'function') {\n      if (\n        fileNames.some((input) => {\n          try {\n            if (rule(input)) {\n              return true\n            }\n          } catch (_) {}\n          return false\n        })\n      ) {\n        return true\n      }\n    }\n\n    if (Array.isArray(rule) && rule.some(canMatchCss)) {\n      return true\n    }\n\n    return false\n  }\n\n  const hasUserCssConfig =\n    webpackConfig.module?.rules.some(\n      (rule) => canMatchCss(rule.test) || canMatchCss(rule.include)\n    ) ?? false\n\n  if (hasUserCssConfig) {\n    // only show warning for one build\n    if (isServer) {\n      console.warn(\n        chalk.yellow.bold('Warning: ') +\n          chalk.bold(\n            'Built-in CSS support is being disabled due to custom CSS configuration being detected.\\n'\n          ) +\n          'See here for more info: https://err.sh/next.js/built-in-css-disabled\\n'\n      )\n    }\n\n    if (webpackConfig.module?.rules.length) {\n      // Remove default CSS Loader\n      webpackConfig.module.rules = webpackConfig.module.rules.filter(\n        (r) =>\n          !(\n            typeof r.oneOf?.[0]?.options === 'object' &&\n            r.oneOf[0].options.__next_css_remove === true\n          )\n      )\n    }\n    if (webpackConfig.plugins?.length) {\n      // Disable CSS Extraction Plugin\n      webpackConfig.plugins = webpackConfig.plugins.filter(\n        (p) => (p as any).__next_css_remove !== true\n      )\n    }\n    if (webpackConfig.optimization?.minimizer?.length) {\n      // Disable CSS Minifier\n      webpackConfig.optimization.minimizer = webpackConfig.optimization.minimizer.filter(\n        (e) => (e as any).__next_css_remove !== true\n      )\n    }\n  } else if (!config.future.strictPostcssConfiguration) {\n    await __overrideCssConfiguration(dir, !dev, webpackConfig)\n  }\n\n  // Inject missing React Refresh loaders so that development mode is fast:\n  if (hasReactRefresh) {\n    attachReactRefresh(webpackConfig, defaultLoaders.babel)\n  }\n\n  // check if using @zeit/next-typescript and show warning\n  if (\n    isServer &&\n    webpackConfig.module &&\n    Array.isArray(webpackConfig.module.rules)\n  ) {\n    let foundTsRule = false\n\n    webpackConfig.module.rules = webpackConfig.module.rules.filter(\n      (rule): boolean => {\n        if (!(rule.test instanceof RegExp)) return true\n        if ('noop.ts'.match(rule.test) && !'noop.js'.match(rule.test)) {\n          // remove if it matches @zeit/next-typescript\n          foundTsRule = rule.use === defaultLoaders.babel\n          return !foundTsRule\n        }\n        return true\n      }\n    )\n\n    if (foundTsRule) {\n      console.warn(\n        '\\n@zeit/next-typescript is no longer needed since Next.js has built-in support for TypeScript now. Please remove it from your next.config.js and your .babelrc\\n'\n      )\n    }\n  }\n\n  // Patch `@zeit/next-sass`, `@zeit/next-less`, `@zeit/next-stylus` for compatibility\n  if (webpackConfig.module && Array.isArray(webpackConfig.module.rules)) {\n    ;[].forEach.call(webpackConfig.module.rules, function (\n      rule: webpack.RuleSetRule\n    ) {\n      if (!(rule.test instanceof RegExp && Array.isArray(rule.use))) {\n        return\n      }\n\n      const isSass =\n        rule.test.source === '\\\\.scss$' || rule.test.source === '\\\\.sass$'\n      const isLess = rule.test.source === '\\\\.less$'\n      const isCss = rule.test.source === '\\\\.css$'\n      const isStylus = rule.test.source === '\\\\.styl$'\n\n      // Check if the rule we're iterating over applies to Sass, Less, or CSS\n      if (!(isSass || isLess || isCss || isStylus)) {\n        return\n      }\n\n      ;[].forEach.call(rule.use, function (use: webpack.RuleSetUseItem) {\n        if (\n          !(\n            use &&\n            typeof use === 'object' &&\n            // Identify use statements only pertaining to `css-loader`\n            (use.loader === 'css-loader' ||\n              use.loader === 'css-loader/locals') &&\n            use.options &&\n            typeof use.options === 'object' &&\n            // The `minimize` property is a good heuristic that we need to\n            // perform this hack. The `minimize` property was only valid on\n            // old `css-loader` versions. Custom setups (that aren't next-sass,\n            // next-less or next-stylus) likely have the newer version.\n            // We still handle this gracefully below.\n            (Object.prototype.hasOwnProperty.call(use.options, 'minimize') ||\n              Object.prototype.hasOwnProperty.call(\n                use.options,\n                'exportOnlyLocals'\n              ))\n          )\n        ) {\n          return\n        }\n\n        // Try to monkey patch within a try-catch. We shouldn't fail the build\n        // if we cannot pull this off.\n        // The user may not even be using the `next-sass` or `next-less` or\n        // `next-stylus` plugins.\n        // If it does work, great!\n        try {\n          // Resolve the version of `@zeit/next-css` as depended on by the Sass,\n          // Less or Stylus plugin.\n          const correctNextCss = require.resolve('@zeit/next-css', {\n            paths: [\n              isCss\n                ? // Resolve `@zeit/next-css` from the base directory\n                  dir\n                : // Else, resolve it from the specific plugins\n                  require.resolve(\n                    isSass\n                      ? '@zeit/next-sass'\n                      : isLess\n                      ? '@zeit/next-less'\n                      : isStylus\n                      ? '@zeit/next-stylus'\n                      : 'next'\n                  ),\n            ],\n          })\n\n          // If we found `@zeit/next-css` ...\n          if (correctNextCss) {\n            // ... resolve the version of `css-loader` shipped with that\n            // package instead of whichever was hoisted highest in your\n            // `node_modules` tree.\n            const correctCssLoader = require.resolve(use.loader, {\n              paths: [correctNextCss],\n            })\n            if (correctCssLoader) {\n              // We saved the user from a failed build!\n              use.loader = correctCssLoader\n            }\n          }\n        } catch (_) {\n          // The error is not required to be handled.\n        }\n      })\n    })\n  }\n\n  // Backwards compat for `main.js` entry key\n  const originalEntry: any = webpackConfig.entry\n  if (typeof originalEntry !== 'undefined') {\n    webpackConfig.entry = async () => {\n      const entry: WebpackEntrypoints =\n        typeof originalEntry === 'function'\n          ? await originalEntry()\n          : originalEntry\n      // Server compilation doesn't have main.js\n      if (clientEntries && entry['main.js'] && entry['main.js'].length > 0) {\n        const originalFile = clientEntries[\n          CLIENT_STATIC_FILES_RUNTIME_MAIN\n        ] as string\n        entry[CLIENT_STATIC_FILES_RUNTIME_MAIN] = [\n          ...entry['main.js'],\n          originalFile,\n        ]\n      }\n      delete entry['main.js']\n\n      return entry\n    }\n  }\n\n  if (!dev) {\n    // entry is always a function\n    webpackConfig.entry = await (webpackConfig.entry as webpack.EntryFunc)()\n  }\n\n  return webpackConfig\n}\n"]}