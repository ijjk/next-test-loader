{"version":3,"sources":["build/webpack/plugins/wellknown-errors-plugin/parseNotFoundError.ts"],"sourcesContent":["import Chalk from 'chalk'\nimport { SimpleWebpackError } from './simpleWebpackError'\nimport { createOriginalStackFrame } from '@next/react-dev-overlay/lib/middleware'\n\nconst chalk = new Chalk.constructor({ enabled: true })\n\nexport async function getNotFoundError(\n  compilation: any,\n  input: any,\n  fileName: string\n) {\n  if (input.name !== 'ModuleNotFoundError') {\n    return false\n  }\n\n  const loc = input.loc\n    ? input.loc\n    : input.dependencies.map((d: any) => d.loc).filter(Boolean)[0]\n  const originalSource = input.module.originalSource()\n\n  try {\n    const result = await createOriginalStackFrame({\n      line: loc.start.line,\n      column: loc.start.column,\n      source: originalSource,\n      rootDirectory: compilation.options.context,\n      frame: {},\n    })\n\n    // If we could not result the original location we still need to show the existing error\n    if (!result) {\n      return input\n    }\n\n    const errorMessage = input.error.message\n      .replace(/ in '.*?'/, '')\n      .replace(/Can't resolve '(.*)'/, `Can't resolve '${chalk.green('$1')}'`)\n\n    const message =\n      chalk.red.bold('Module not found') +\n      `: ${errorMessage}` +\n      '\\n' +\n      result.originalCodeFrame\n\n    return new SimpleWebpackError(\n      `${chalk.cyan(fileName)}:${chalk.yellow(\n        result.originalStackFrame.lineNumber?.toString() ?? ''\n      )}:${chalk.yellow(result.originalStackFrame.column?.toString() ?? '')}`,\n      message\n    )\n  } catch (err) {\n    console.log('Failed to parse source map:', err)\n    // Don't fail on failure to resolve sourcemaps\n    return input\n  }\n}\n"],"names":[],"mappings":";;;;QAMsB,gBAAgB,GAAhB,gBAAgB;AANpB,GAAO,CAAP,MAAO;AACU,GAAsB,CAAtB,mBAAsB;AAChB,GAAwC,CAAxC,WAAwC;;;;;;AAEjF,KAAK,CAAC,KAAK,GAAG,GAAG,CAJC,MAAO,SAID,WAAW;IAAG,OAAO,EAAE,IAAI;;eAE7B,gBAAgB,CACpC,WAAgB,EAChB,KAAU,EACV,QAAgB,EAChB,CAAC;IACD,EAAE,EAAE,KAAK,CAAC,IAAI,MAAK,mBAAqB,GAAE,CAAC;eAClC,KAAK;IACd,CAAC;IAED,KAAK,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,GACjB,KAAK,CAAC,GAAG,GACT,KAAK,CAAC,YAAY,CAAC,GAAG,EAAE,CAAM,GAAK,CAAC,CAAC,GAAG;MAAE,MAAM,CAAC,OAAO,EAAE,CAAC;IAC/D,KAAK,CAAC,cAAc,GAAG,KAAK,CAAC,MAAM,CAAC,cAAc;QAE9C,CAAC;YA0BC,GAAoC,EACpB,IAAgC;QA1BpD,KAAK,CAAC,MAAM,aAnByB,WAAwC;YAoB3E,IAAI,EAAE,GAAG,CAAC,KAAK,CAAC,IAAI;YACpB,MAAM,EAAE,GAAG,CAAC,KAAK,CAAC,MAAM;YACxB,MAAM,EAAE,cAAc;YACtB,aAAa,EAAE,WAAW,CAAC,OAAO,CAAC,OAAO;YAC1C,KAAK;;;QAGP,EAAwF,AAAxF,sFAAwF;QACxF,EAAE,GAAG,MAAM,EAAE,CAAC;mBACL,KAAK;QACd,CAAC;QAED,KAAK,CAAC,YAAY,GAAG,KAAK,CAAC,KAAK,CAAC,OAAO,CACrC,OAAO,kBACP,OAAO,0BAA0B,eAAe,EAAE,KAAK,CAAC,KAAK,EAAC,EAAI,GAAE,CAAC;QAExE,KAAK,CAAC,OAAO,GACX,KAAK,CAAC,GAAG,CAAC,IAAI,EAAC,gBAAkB,MAChC,EAAE,EAAE,YAAY,MACjB,EAAI,IACJ,MAAM,CAAC,iBAAiB;YAItB,IAAgD,EAChC,IAA4C;eAHzD,GAAG,CA3CqB,mBAAsB,uBA4ChD,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,EAAE,KAAK,CAAC,MAAM,EACrC,IAAgD,IAAhD,GAAoC,GAApC,MAAM,CAAC,kBAAkB,CAAC,UAAU,cAApC,GAAoC,UAApC,CAA8C,QAA9C,CAA8C,GAA9C,GAAoC,CAAE,QAAQ,gBAA9C,IAAgD,cAAhD,IAAgD,OAChD,CAAC,EAAE,KAAK,CAAC,MAAM,EAAC,IAA4C,IAA5C,IAAgC,GAAhC,MAAM,CAAC,kBAAkB,CAAC,MAAM,cAAhC,IAAgC,UAAhC,CAA0C,QAA1C,CAA0C,GAA1C,IAAgC,CAAE,QAAQ,gBAA1C,IAA4C,cAA5C,IAA4C,UAC9D,OAAO;IAEX,CAAC,QAAQ,GAAG,EAAE,CAAC;QACb,OAAO,CAAC,GAAG,EAAC,2BAA6B,GAAE,GAAG;QAC9C,EAA8C,AAA9C,4CAA8C;eACvC,KAAK;IACd,CAAC;AACH,CAAC"}